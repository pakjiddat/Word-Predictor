<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Features â€¢ Word Predictor</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Features">
<meta property="og:description" content="wordpredictor">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Word Predictor</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/features.html">Features</a>
    </li>
    <li>
      <a href="../articles/overview.html">Overview</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/pakjiddat/word-predictor/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Features</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pakjiddat/word-predictor/blob/master/vignettes/features.Rmd"><code>vignettes/features.Rmd</code></a></small>
      <div class="hidden name"><code>features.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This document describes all the features provided by the <strong>wordpredictor</strong> package. It first describes how to generate n-gram models. Next it describes how to evaluate the performance of the model. Finally it describes how to make word predictions using the model.</p>
</div>
<div id="model-generation" class="section level2">
<h2 class="hasAnchor">
<a href="#model-generation" class="anchor"></a>Model Generation</h2>
<p>The <strong>wordpredictor</strong> package provides several classes that can be used to generate n-gram models. These classes may be used to generate n-gram models step by step. An alternative is to use the <strong>ModelGenerator</strong> class which combines all the steps and provides a single method for generating n-gram models.</p>
<p>The following steps are involved in generating n-gram models:</p>
<div id="data-exploration" class="section level3">
<h3 class="hasAnchor">
<a href="#data-exploration" class="anchor"></a>Data Exploration</h3>
<p>The first step in generating a n-gram model is data exploration. This involves determining the type of textual content and various text related statistics. The type of text may be news content, blog posts, Twitter feeds, product reviews, customer chat history etc. Example of text related statistics are line count, word count, average line length and input file size.</p>
<p>It is also important to determine the un-wanted words and symbols in the data such as vulgar words, punctuation symbols, non-alphabetical symbols etc. The <strong>wordpredictor</strong> package provides the <strong>DataAnalyzer</strong> class which can be used to find out statistics about the input data. The following example shows how to get statistics on all text files within a folder:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The DataAnalyzer object is created</span>
<span class="va">da</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/DataAnalyzer.html">DataAnalyzer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>
<span class="co"># Information on all text files in the ddir2 folder is returned</span>
<span class="va">fi</span> <span class="op">&lt;-</span> <span class="va">da</span><span class="op">$</span><span class="fu">get_file_info</span><span class="op">(</span><span class="va">ddir2</span><span class="op">)</span>
<span class="co"># The file information is printed</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">fi</span><span class="op">)</span>
<span class="co">#&gt; $file_stats</span>
<span class="co">#&gt;                                           fn total_lc max_ll min_ll mean_ll</span>
<span class="co">#&gt; 1    ../tests/testthat/data2/input-clean.txt   124357    916      4      83</span>
<span class="co">#&gt; 2          ../tests/testthat/data2/input.txt    51236   5883      2     229</span>
<span class="co">#&gt; 3     ../tests/testthat/data2/test-clean.txt    12562    820      4      82</span>
<span class="co">#&gt; 4           ../tests/testthat/data2/test.txt     5125   2508      2     230</span>
<span class="co">#&gt; 5          ../tests/testthat/data2/train.txt    40989   5883      2     229</span>
<span class="co">#&gt; 6 ../tests/testthat/data2/validate-clean.txt    12320    681      4      83</span>
<span class="co">#&gt; 7       ../tests/testthat/data2/validate.txt     5125   2061      2     226</span>
<span class="co">#&gt;        size</span>
<span class="co">#&gt; 1    9.9 Mb</span>
<span class="co">#&gt; 2   11.3 Mb</span>
<span class="co">#&gt; 3 1022.1 Kb</span>
<span class="co">#&gt; 4    1.1 Mb</span>
<span class="co">#&gt; 5      9 Mb</span>
<span class="co">#&gt; 6 1007.5 Kb</span>
<span class="co">#&gt; 7    1.1 Mb</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $overall_stats</span>
<span class="co">#&gt;   total_lc max_ll min_ll mean_ll total_s</span>
<span class="co">#&gt; 1   251714   5883      4     230 34.5 Mb</span></code></pre></div>
<p>The word count of a text file can be fetched using the command: <code>cat file-name | wc -w</code>. This command should work on all Unix based systems.</p>
</div>
<div id="data-sampling" class="section level3">
<h3 class="hasAnchor">
<a href="#data-sampling" class="anchor"></a>Data Sampling</h3>
<p>The next step is to generate training, testing and validation samples from the input text file. If there are many input text files, then they can be combined to a single file using the command: <code>cat file-1 file-2 file3 &gt; output-file</code>. The contents of the combined text file may need to be randomized.</p>
<p>The <strong>wordpredictor</strong> package provides the <strong>DataSampler</strong> class which can be used to generate a random sample containing given number of lines. The following example shows how to generate a random sample of size 10 Mb from an input text file:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The sample size in Mb</span>
<span class="va">ssize</span> <span class="op">&lt;-</span> <span class="fl">10</span>
<span class="co"># The data file path</span>
<span class="va">dfp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">ddir2</span>, <span class="st">"/input.txt"</span><span class="op">)</span>

<span class="co"># The object size is formatted</span>
<span class="va">obj_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.info.html">file.size</a></span><span class="op">(</span><span class="va">dfp</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">^</span><span class="fl">6</span>
<span class="co"># The proportion of data to sample</span>
<span class="va">prop</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ssize</span><span class="op">/</span><span class="va">obj_size</span><span class="op">)</span>
<span class="co"># An object of class DataSampler is created</span>
<span class="va">ds</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/DataSampler.html">DataSampler</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>ddir <span class="op">=</span> <span class="va">ddir2</span>, mdir <span class="op">=</span> <span class="va">ddir2</span><span class="op">)</span>
<span class="co"># The sample file is generated.</span>
<span class="co"># The randomized sample is saved to the file train.txt in the ddir</span>
<span class="va">ds</span><span class="op">$</span><span class="fu">generate_sample</span><span class="op">(</span>
    fn <span class="op">=</span>  <span class="st">"input.txt"</span>,
    ss <span class="op">=</span> <span class="va">prop</span>,
    ic <span class="op">=</span> <span class="cn">F</span>,
    ir <span class="op">=</span> <span class="cn">T</span>,
    t <span class="op">=</span> <span class="st">"tr"</span>,
    is <span class="op">=</span> <span class="cn">T</span>
<span class="op">)</span></code></pre></div>
<p>Usually we need a train dataset for generating the n-gram model. A test dataset for testing the model and a validation dataset for evaluating the performance of the model. The following example shows how to generate the train, test and validation files. The train file contains the first 80% of the lines, the test set contains the next 10% of the lines. The remaining lines are in the validation set.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># An object of class DataSampler is created</span>
<span class="va">ds</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/DataSampler.html">DataSampler</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>ddir <span class="op">=</span> <span class="va">ddir2</span>, mdir <span class="op">=</span> <span class="va">ddir2</span><span class="op">)</span>
<span class="co"># The train, test and validation files are generated</span>
<span class="va">ds</span><span class="op">$</span><span class="fu">generate_data</span><span class="op">(</span>
    fn <span class="op">=</span>  <span class="st">"input.txt"</span>,
    dir <span class="op">=</span> <span class="va">ddir2</span>,
    percs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">"train"</span> <span class="op">=</span> <span class="fl">0.8</span>,
        <span class="st">"test"</span> <span class="op">=</span> <span class="fl">0.1</span>,
        <span class="st">"validate"</span> <span class="op">=</span> <span class="fl">0.1</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>In the above example, <strong>ddir</strong> parameter is the data directory containing the <strong>input.txt</strong> file. <strong>mdir</strong> parameter is the output directory that will contain the generated test, validation and train data files.</p>
</div>
<div id="data-cleaning" class="section level3">
<h3 class="hasAnchor">
<a href="#data-cleaning" class="anchor"></a>Data Cleaning</h3>
<p>The next step is to remove un-wanted symbols and words from the input text file. This reduces the memory requirement of the n-gram model and makes it more efficient. Example of un-wanted words are vulgar words and words that are not part of the vacabulary. Punctuation, numbers, non-printable characters, extra spaces may also be removed.</p>
<p>The <strong>wordpredictor</strong> package provides the <strong>DataCleaner</strong> class which can be used to remove un-wanted words and symbols from text files. The following example shows how to clean a given text file:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The data file path</span>
<span class="va">fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">ddir2</span>, <span class="st">"/input.txt"</span><span class="op">)</span>
<span class="co"># The data cleaning options</span>
<span class="va">dc_opts</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="st">"min_words"</span> <span class="op">=</span> <span class="fl">2</span>,
    <span class="st">"to_lower"</span> <span class="op">=</span> <span class="cn">T</span>,
    <span class="st">"remove_stop"</span> <span class="op">=</span> <span class="cn">F</span>,
    <span class="st">"remove_punct"</span> <span class="op">=</span> <span class="cn">T</span>,
    <span class="st">"remove_non_dict"</span> <span class="op">=</span> <span class="cn">T</span>,
    <span class="st">"remove_non_alpha"</span> <span class="op">=</span> <span class="cn">T</span>,
    <span class="st">"remove_extra_space"</span> <span class="op">=</span> <span class="cn">T</span>,
    <span class="st">"remove_bad"</span> <span class="op">=</span> <span class="cn">F</span>
<span class="op">)</span>
<span class="co"># The data cleaner object is created</span>
<span class="va">dc</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/DataCleaner.html">DataCleaner</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">fn</span>, <span class="va">dc_opts</span><span class="op">)</span>
<span class="co"># The sample file is cleaned and saved as input-clean.txt in the ddir</span>
<span class="va">dc</span><span class="op">$</span><span class="fu">clean_file</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>The <strong>clean_file</strong> method reads a certain number of lines at a time, cleans the lines of text and saves them to an output text file. It is useful for cleaning large text files.</p>
</div>
<div id="tokenization" class="section level3">
<h3 class="hasAnchor">
<a href="#tokenization" class="anchor"></a>Tokenization</h3>
<p>The next step is to generate n-gram tokens from the cleaned text file. The <strong>TokenGenerator</strong> class allows generating n-gram tokens of given size from a given input text file. The following example shows how to generate n-grams tokens of size 3:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The test file path</span>
<span class="va">fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">ddir2</span>, <span class="st">"/test.txt"</span><span class="op">)</span>
<span class="co"># The ngram number is set</span>
<span class="va">tg_opts</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"n"</span> <span class="op">=</span> <span class="fl">3</span>, <span class="st">"save_ngrams"</span> <span class="op">=</span> <span class="cn">T</span>, dir <span class="op">=</span> <span class="va">mdir</span><span class="op">)</span>
<span class="co"># The TokenGenerator object is created</span>
<span class="va">tg</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/TokenGenerator.html">TokenGenerator</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">fn</span>, <span class="va">tg_opts</span><span class="op">)</span>
<span class="co"># The ngram tokens are generated</span>
<span class="va">tg</span><span class="op">$</span><span class="fu">generate_tokens</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>The above code generates the file <strong>n3.RDS</strong> in the model directory. This file contains 3-gram tokens along with their frequencies. N-gram files of size 1, 2, 3, 4 and so on can be generated in this way. The larger the n-gram size, the higher the memory requirement for the n-gram model. Usually n-grams of size 4 are generated.</p>
<p>Two important customization options supported by the class are <strong>min_freq</strong> and <strong>stem_words</strong>. <strong>min_freq</strong> sets minimum frequency for n-gram tokens. All n-gram tokens with frequency less than <strong>min_freq</strong> are excluded. When the <strong>stem_words</strong> option is used, n-gram prefix components are stemmed. The next word is not transformed.</p>
<p>The n-gram token frequencies may be analyzed using the <strong>DataAnalyzer</strong> class. The following example displays the top most occuring n-gram tokens:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The ngram file name</span>
<span class="va">fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">ddir2</span>, <span class="st">"/n3.RDS"</span><span class="op">)</span>
<span class="co"># The DataAnalyzer object is created</span>
<span class="va">da</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/DataAnalyzer.html">DataAnalyzer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">fn</span><span class="op">)</span>
<span class="co"># The top features plot is checked</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">da</span><span class="op">$</span><span class="fu">plot_n_gram_stats</span><span class="op">(</span>opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="st">"type"</span> <span class="op">=</span> <span class="st">"top_features"</span>,
    <span class="st">"n"</span> <span class="op">=</span> <span class="fl">10</span>,
    <span class="st">"save_to"</span> <span class="op">=</span> <span class="cn">NULL</span>,
    <span class="st">"dir"</span> <span class="op">=</span> <span class="va">sdir</span>
<span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="man/figures/README-tokenization-2-1.png" width="480"></p>
<p>The following example shows the distribution of word frequencies:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The ngram file name</span>
<span class="va">fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">ddir2</span>, <span class="st">"/n3.RDS"</span><span class="op">)</span>
<span class="co"># The DataAnalyzer object is created</span>
<span class="va">da</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/DataAnalyzer.html">DataAnalyzer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">fn</span><span class="op">)</span>
<span class="co"># The top features plot is checked</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">da</span><span class="op">$</span><span class="fu">plot_n_gram_stats</span><span class="op">(</span>opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="st">"type"</span> <span class="op">=</span> <span class="st">"coverage"</span>,
    <span class="st">"n"</span> <span class="op">=</span> <span class="fl">10</span>,
    <span class="st">"save_to"</span> <span class="op">=</span> <span class="cn">NULL</span>,
    <span class="st">"dir"</span> <span class="op">=</span> <span class="va">sdir</span>
<span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="man/figures/README-tokenization-3-1.png" width="480"></p>
<p>The following example returns all 3-gram tokens that start with <strong>great_</strong>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The ngram file name</span>
<span class="va">fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">ddir2</span>, <span class="st">"/n3.RDS"</span><span class="op">)</span>
<span class="co"># The DataAnalyzer object is created</span>
<span class="va">da</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/DataAnalyzer.html">DataAnalyzer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>
<span class="co"># Bi-grams starting with "great_" are returned</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">da</span><span class="op">$</span><span class="fu">get_ngrams</span><span class="op">(</span>fn <span class="op">=</span> <span class="va">fn</span>, c <span class="op">=</span> <span class="fl">10</span>, pre <span class="op">=</span> <span class="st">"^great_*"</span><span class="op">)</span>
<span class="co"># The data frame is sorted by frequency</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">freq</span>, decreasing <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,<span class="op">]</span>
<span class="co"># The data frame is printed</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 140 x 2</span>
<span class="co">#&gt;    pre                      freq</span>
<span class="co">#&gt;    &lt;fct&gt;                   &lt;dbl&gt;</span>
<span class="co">#&gt;  1 great_from_the              2</span>
<span class="co">#&gt;  2 great_idea_to               2</span>
<span class="co">#&gt;  3 great_to_be                 2</span>
<span class="co">#&gt;  4 great_to_see                2</span>
<span class="co">#&gt;  5 greater_than_our            2</span>
<span class="co">#&gt;  6 great_ability_to            1</span>
<span class="co">#&gt;  7 great_about_is              1</span>
<span class="co">#&gt;  8 great_accidents_that        1</span>
<span class="co">#&gt;  9 great_ambassadors_and       1</span>
<span class="co">#&gt; 10 great_american_festival     1</span>
<span class="co">#&gt; # â€¦ with 130 more rows</span></code></pre></div>
</div>
<div id="transition-probabilities" class="section level3">
<h3 class="hasAnchor">
<a href="#transition-probabilities" class="anchor"></a>Transition Probabilities</h3>
<p>The next step in generating the n-gram model is to generate transition probabilities from the n-gram files. The <strong>TPGenerator</strong> class is used to generate the transition probabilities. For each n-gram token file a corresponding transition probabilities file is generated.</p>
<p>The transition probabilities files are then combined into a single file containing transition probability data for n-grams of size 1, 2, 3, 4 etc.</p>
<p>The following example shows how to generate combined transition probabilities for n-grams of size 1, 2, 3 and 4:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The TPGenerator object is created</span>
<span class="va">tp</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/TPGenerator.html">TPGenerator</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">4</span>, dir <span class="op">=</span> <span class="va">ddir2</span><span class="op">)</span><span class="op">)</span>
<span class="co"># The combined transition probabilities are generated</span>
<span class="va">tp</span><span class="op">$</span><span class="fu">generate_tp</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>The above code produces the final <strong>model-4.RDS</strong>.</p>
</div>
<div id="the-model-file" class="section level3">
<h3 class="hasAnchor">
<a href="#the-model-file" class="anchor"></a>The model file</h3>
<p>The final step is to generate a n-gram model file from the files generated in the previous steps. The <strong>Model</strong> class contains the method <strong>load_model</strong>, which reads the combined transition probabilities files and other files that are used by the model. An instance of the <strong>Model</strong> class represents the n-gram model.</p>
</div>
<div id="generating-the-model-in-one-step" class="section level3">
<h3 class="hasAnchor">
<a href="#generating-the-model-in-one-step" class="anchor"></a>Generating the model in one step</h3>
<p>All the previous steps may be combined into a single step. The <strong>ModelGenerator</strong> class allows generating the final n-gram model using a single method call. The following example generates a n-gram model using default data cleaning and tokenization options:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The following code generates n-gram model using default options for data</span>
<span class="co"># cleaning and tokenization. See the following section on how to customize these</span>
<span class="co"># options. Note that input.txt is the name of the input data file. It should be</span>
<span class="co"># present in the data directory. ddir is the data directory. mdir is the model</span>
<span class="co"># directory. The output model file, which is def-model.RDS will be placed in</span>
<span class="co"># this directory.</span>

<span class="co"># ModelGenerator class object is created</span>
<span class="va">mg</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/ModelGenerator.html">ModelGenerator</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
    name <span class="op">=</span> <span class="st">"def-model"</span>,
    desc <span class="op">=</span> <span class="st">"N-gram model generating using default options"</span>,
    fn <span class="op">=</span> <span class="st">"def-model.RDS"</span>,
    df <span class="op">=</span> <span class="st">"input.txt"</span>,
    n <span class="op">=</span> <span class="fl">4</span>,
    ssize <span class="op">=</span> <span class="fl">10</span>,
    ddir <span class="op">=</span> <span class="va">ddir1</span>,
    mdir <span class="op">=</span> <span class="va">mdir</span>,
    dc_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>,
    tg_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>,
    ve <span class="op">=</span> <span class="fl">2</span>
<span class="op">)</span>

<span class="co"># Generates n-gram model. The output is the file</span>
<span class="co"># ./data/model/def-model.RDS</span>
<span class="va">mg</span><span class="op">$</span><span class="fu">generate_model</span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="evaluating-the-model-performance" class="section level2">
<h2 class="hasAnchor">
<a href="#evaluating-the-model-performance" class="anchor"></a>Evaluating the model performance</h2>
<p>The <strong>wordpredictor</strong> package provides the <strong>ModelEvaluator</strong> class for evaluating the performance of the generated n-gram model. Intrinsic and Extrinsic evaluation are supported. Also the performance of several n-gram models may be compared.</p>
<p>The following example performs Intrinsic evaluation. It measures the Perplexity score for each sentence in the <strong>validation.txt</strong> file, that was generated in the data sampling step. It returns the minimum, mean and maximum Perplexity score for each line.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The model file name</span>
<span class="va">mfn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">mdir</span>, <span class="st">"/def-model.RDS"</span><span class="op">)</span>
<span class="co"># The path to the cleaned validation file</span>
<span class="va">vfn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">mdir</span>, <span class="st">"/validate.txt"</span><span class="op">)</span>
<span class="co"># ModelEvaluator class object is created</span>
<span class="va">me</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/ModelEvaluator.html">ModelEvaluator</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>mf <span class="op">=</span> <span class="va">mfn</span><span class="op">)</span>
<span class="co"># The intrinsic evaluation is performed on first 20 lines</span>
<span class="va">stats</span> <span class="op">&lt;-</span> <span class="va">me</span><span class="op">$</span><span class="fu">intrinsic_evaluation</span><span class="op">(</span>lc <span class="op">=</span> <span class="fl">20</span>, fn <span class="op">=</span> <span class="va">vfn</span><span class="op">)</span></code></pre></div>
<p>The following example performs Extrinsic evaluation. It measures the accuracy score for each sentence in <strong>validation.txt</strong> file. For each sentence the model is used to predict the last word in the sentence given the previous words. If the last word was correctly predicted, then the prediction is considered to be accurate. The Extrinsic evaluation returns the number of correct and incorrect predictions.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The model file name</span>
<span class="va">mfn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">mdir</span>, <span class="st">"/def-model.RDS"</span><span class="op">)</span>
<span class="co"># The path to the cleaned validation file</span>
<span class="va">vfn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">mdir</span>, <span class="st">"/validate.txt"</span><span class="op">)</span>
<span class="co"># ModelEvaluator class object is created</span>
<span class="va">me</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/ModelEvaluator.html">ModelEvaluator</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>mf <span class="op">=</span> <span class="va">mfn</span><span class="op">)</span>
<span class="co"># The intrinsic evaluation is performed on first 100 lines</span>
<span class="va">stats</span> <span class="op">&lt;-</span> <span class="va">me</span><span class="op">$</span><span class="fu">extrinsic_evaluation</span><span class="op">(</span>lc <span class="op">=</span> <span class="fl">100</span>, fn <span class="op">=</span> <span class="va">vfn</span><span class="op">)</span></code></pre></div>
</div>
<div id="making-word-predictions" class="section level2">
<h2 class="hasAnchor">
<a href="#making-word-predictions" class="anchor"></a>Making word predictions</h2>
<p>The n-gram model generated in the previous step can be used to predict the next word given a set of words. The following example shows how to predict the next word. It returns the 3 possible next words along with their probabilities.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The model file name</span>
<span class="va">mfn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">mdir</span>, <span class="st">"/def-model.RDS"</span><span class="op">)</span>
<span class="co"># An object of class ModelPredictor is created. The mf parameter is the name of</span>
<span class="co"># the model file that was generated in the previous example.</span>
<span class="va">mp</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/ModelPredictor.html">ModelPredictor</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>mf <span class="op">=</span> <span class="va">mfn</span><span class="op">)</span>
<span class="co"># Given the words: "how are", the next word is predicted. The top 3 most likely</span>
<span class="co"># next words are returned along with their respective probabilities.</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="va">mp</span><span class="op">$</span><span class="fu">predict_word</span><span class="op">(</span>words <span class="op">=</span> <span class="st">"how are"</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Nadir Latif.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
